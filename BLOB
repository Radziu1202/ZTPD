 zadanie 1
 
 CREATE TABLE "MOVIES" 
   (	"ID" NUMBER(12,0) NOT NULL ENABLE, 
	"TITLE" VARCHAR2(400 BYTE) NOT NULL ENABLE, 
	"CATEGORY" VARCHAR2(50 BYTE), 
	"YEAR" CHAR(4 BYTE), 
	"CAST" VARCHAR2(4000 BYTE), 
	"DIRECTOR" VARCHAR2(4000 BYTE), 
	"STORY" VARCHAR2(4000 BYTE), 
	"PRICE" NUMBER(5,2), 
	"COVER" BLOB, 
	"MIME_TYPE" VARCHAR2(50 BYTE), 
	 CONSTRAINT "MOVIES_PK" PRIMARY KEY ("ID")
)

zadanie 2
insert into movies(ID,TITLE,CATEGORY,YEAR,CAST,DIRECTOR,STORY,PRICE,COVER,MIME_TYPE) 
select ID,TITLE,CATEGORY,TRIM(YEAR),CAST,DIRECTOR,STORY,PRICE,IMAGE,MIME_TYPE 
from descriptions d
full OUTER JOIN COVERS c ON c.MOVIE_ID=d.ID;


ZADANIE 3
SELECT * FROM MOVIES WHERE COVER IS NULL;

ZADANIE 4
SELECT ID, TITLE, DBMS_LOB.GETLENGTH(COVER) AS FILESIZE FROM MOVIES WHERE COVER IS NOT NULL;


ZADANIE 5
SELECT ID, TITLE, DBMS_LOB.GETLENGTH(COVER) AS FILESIZE FROM MOVIES WHERE COVER IS  NULL;

ZADANIE 6
SELECT * FROM ALL_DIRECTORIES;

ZADANIE 7
UPDATE MOVIES SET COVER = EMPTY_BLOB(), MIME_TYPE = 'IMAGE/JPEG' WHERE ID = '66';

ZADANIE 8
SELECT ID, TITLE, DBMS_LOB.GETLENGTH(COVER) AS FILESIZE FROM MOVIES WHERE ID IN( 65 ,66);

ZADANIE 9
DECLARE
    BLOB_VAR blob;
    B_FILE_VAR BFILE := BFILENAME('ZSBD_DIR','escape.jpg');
BEGIN
    SELECT COVER INTO BLOB_VAR
    FROM MOVIES WHERE id=66 FOR UPDATE;
    DBMS_LOB.FILEOPEN(B_FILE_VAR, DBMS_LOB.FILE_READONLY);
    DBMS_LOB.LOADFROMFILE(BLOB_VAR,B_FILE_VAR,DBMS_LOB.GETLENGTH(B_FILE_VAR));
    DBMS_LOB.FILECLOSE(B_FILE_VAR);
COMMIT;
END;

ZADANIE 10
CREATE TABLE TEMP_COVERS(MOVIE_ID NUMBER(12),IMAGE BFILE,MIME_TYPE VARCHAR2(50));

ZADANIE 11
INSERT INTO TEMP_COVERS VALUES(
    65, 
    BFILENAME('ZSBD_DIR','eagles.jpg'),
    'IMAGE/JPEG'
    );
    
ZADANIE 12
SELECT MOVIE_ID, DBMS_LOB.GETLENGTH(IMAGE) AS FILESIZE FROM TEMP_COVERS;


ZADANIE 13
DECLARE
    BLOB_VAR BLOB;
    B_FILE_VAR BFILE;
    MIME_VAR VARCHAR2(250);
BEGIN
    SELECT IMAGE INTO B_FILE_VAR FROM TEMP_COVERS WHERE MOVIE_ID=65;
    SELECT COVER INTO BLOB_VAR FROM MOVIES WHERE ID=65 FOR UPDATE;
    SELECT MIME_TYPE INTO MIME_VAR FROM TEMP_COVERS WHERE MOVIE_ID=65;

    DBMS_LOB.FILEOPEN(B_FILE_VAR, DBMS_LOB.FILE_READONLY);
    DBMS_LOB.CREATETEMPORARY(BLOB_VAR, TRUE);
    DBMS_LOB.LOADFROMFILE(BLOB_VAR,B_FILE_VAR,DBMS_LOB.GETLENGTH(B_FILE_VAR));
    
    UPDATE MOVIES SET COVER = BLOB_VAR, MIME_TYPE = MIME_VAR WHERE ID = 65;
    DBMS_LOB.FREETEMPORARY(BLOB_VAR);
    DBMS_LOB.FILECLOSE(B_FILE_VAR);
COMMIT;
END;

ZADANIE 14
SELECT ID,dbms_lob.GETLENGTH(COVER) AS FILESIZE FROM MOVIES WHERE ID IN('65','66');


ZADANIE 15
DROP TABLE MOVIES;
DROP TABLE TEMP_COVERS;



